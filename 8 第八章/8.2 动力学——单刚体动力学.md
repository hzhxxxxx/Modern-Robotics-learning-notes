因为牛顿—欧拉法建立在单一刚体的动力学上，所以先讨论单刚体动力学。

### 【1】一般刚体动力学：

- 先从一个点开始说：
	假设这个点此时的运动旋量为：$V_{b}=(\omega_{b},v_{b})$，它此时的位置为$p$，则它的速度$\dot{p}$为：$\dot{p}_{i}=v_{b}+\omega_{b}\times p_{i}$
	它的加速度$\ddot{p}$为：$\begin{aligned} \ddot{p}_{i} & =i_{b}+\frac{d}{dt}\omega_{b}\times p_{i}+\omega_{b}\times\frac{d}{dt}p_{i} \\ & =i_{b}+\dot{\omega}_{b}\times p_{i}+\omega_{b}\times(v_{b}+\omega_{b}\times p_{i}) \end{aligned}$
	用向量$r$替代$p$，则根据$\omega_1\times\omega_2=[\omega_1]\omega_2$，上面公式可以等于：$\ddot{p}_{i}=\dot{v}_{b}+[\dot{\omega}_{b}]r_{i}+[\omega_{b}]v_{b}+[\omega_{b}]^{2}r_{i}$

	这样就可以通过$f=ma$这个公式来求出这个点的力：$f_{i}=\mathrm{m}_{i}(\dot{v}_{b}+[\dot{\omega}_{b}]r_{i}+[\omega_{b}]v_{b}+[\omega_{b}]^{2}r_{i})$
	类似的，可以通过$\mathbf{m}=r\times f$力矩公式来求出这个点的力矩：$\mathbf{m}=[r_{i}]f_{i}=[r_{i}]\mathrm{m}_{i}(\dot{v}_{b}+[\dot{\omega}_{b}]r_{i}+[\omega_{b}]v_{b}+[\omega_{b}]^{2}r_{i})$（注意这里的$\mathbf{m}$是力矩的意思！跟质量区分开）

- 推广到一般刚体上：
	把刚体看作很多个离散的质点的集合。
	这里有一个性质$\sum_im_ir_i=0$表示了无数个质点和其的位置向量共同构成了刚体的整体。
	因此刚体的力旋量可以这么表示：$\mathcal{F}_{b}= \begin{bmatrix} {\mathbf{m}_{b}} \\ {f_{b}} \end{bmatrix}= \begin{bmatrix} {\sum_{i}\mathbf{m}_{i}} \\ {\sum_{i}f_{i}} \end{bmatrix}$
	这里有两个固有的矩阵性质：$[{a}]=-[a]^{\mathrm{T}},[a]b=-[b]a$
	
	然后我们先关注力$f_{b}$：![[Pasted image 20250705151220.png]]
	
	再关注力矩$\mathbf{m}_{b}$：
	![[Pasted image 20250705151309.png]]
	注意上面第二步那里，第三项没有被消去是因为它括号里面还有$r_i$，也就是这是$r_i$的二次项，就不为0。
	上面两个图就展示了一般刚体的动力学方程。

- 这里我们引入一个概念：*刚体的转动惯量矩阵*：
	$$\color{#fb8b05}I_{b}=-\sum_{i}\mathfrak{m}_{i}[r_{i}]^{2}$$       转动惯量矩阵能描述刚体绕某个轴的旋转难度。其下标就是那  个轴。
	具体也是前面的思想，把刚体看作离散的无数个质点，然后去算之后总和汇总。只要所有质点用同一坐标系计算，结果就有意义。
	关于转动惯量矩阵$I_{b}$展开是：$$\left.\begin{aligned}\mathcal{I}_{b} & =\quad\left[\begin{array}{ccc}{\sum\mathrm{m}_{i}(y_{i}^{2}+z_{i}^{2})} & {-\sum\mathrm{m}_{i}x_{i}y_{i}} & {-\sum\mathrm{m}_{i}x_{i}z_{i}} \\{-\sum\mathrm{m}_{i}x_{i}y_{i}} & {\sum\mathrm{m}_{i}(x_{i}^{2}+z_{i}^{2})} & {-\sum\mathrm{m}_{i}y_{i}z_{i}} \\{-\sum\mathrm{m}_{i}x_{i}z_{i}} & {-\sum\mathrm{m}_{i}y_{i}z_{i}} & {\sum\mathrm{m}_{i}(x_{i}^{2}+y_{i}^{2})}\end{array}\right.] \\& =\quad\left[\begin{array}{ccc}{\mathcal{I}_{xx}} & {\mathcal{I}_{xy}} & {\mathcal{I}_{xz}} \\{\mathcal{I}_{xy}} & {\mathcal{I}_{yy}} & {\mathcal{I}_{yz}} \\{\mathcal{I}_{xz}} & {\mathcal{I}_{yz}} & {\mathcal{I}_{zz}}\end{array}\right.].\end{aligned}\right.$$主对角线上的元素称为惯性矩：比如第一个$I_{xx}=\sum m_i(y_i^2+z_i^2)$
	代表了刚体绕 $x$-轴旋转时，质点到 $x$-轴的垂直距离平方为 $y_{i}^{2}+z_{i}^{2}$。
	而非对角线元素称为惯性积：
	它代表了两个方向上的旋转趋势会互相拉扯，“当你让刚体绕某个轴旋转时，它会在另一个轴上产生角动量”

	如果用密度函数$\rho(x,y,z)$代表质量$m$，基于微分单元体$dV$，在物体$\mathbf{B}$上积分可得：$$\begin{aligned}& \mathcal{I}_{xx} & & =\quad\int_{\mathcal{B}}(y^2+z^2)\rho(x,y,z)dV \\& \mathcal{I}_{yy} & & =\quad\int_{\mathcal{B}}(x^2+z^2)\rho(x,y,z)dV \\& \mathcal{I}_{zz} & & =\quad\int_{\mathcal{B}}(x^2+y^2)\rho(x,y,z)dV \\& \mathcal{I}_{xy} & & =\quad-\int_{\mathcal{B}}xy\rho(x,y,z)dV \\& \mathcal{I}_{xz} & & =\quad-\int_{\mathcal{B}}xz\rho(x,y,z)dV \\& \mathcal{I}_{yz} & & =\quad-\int_{\mathcal{B}}yz\rho(x,y,z)dV.\end{aligned}$$可以看到如果刚体的密度均匀，则$\mathcal{I}_b$完全由刚体的形状决定。
	
	因此刚体的动能我们也能表达为：$K=\frac{1}{2}\omega_c^\mathrm{T}\mathcal{I}_c\omega_c$（*转动惯量矩阵相当于旋转中的质量$m$*）


- 接下来我们考虑*转动惯量矩阵的参考系转换*：
	因为我们前面提到它本质是刚体绕某个轴旋转的旋转难度，因此只要所有质点用同一坐标系计算就行。$$\begin{aligned}\frac{1}{2}\omega_{c}^{\mathrm{T}}I_{c}\omega_{c} & =\quad\frac{1}{2}\omega_{b}^{\mathrm{T}}\mathcal{I}_{b}\omega_{b} \\& =\quad\frac{1}{2}(R_{bc}\omega_{c})^{\mathrm{T}}\mathcal{I}_{b}(R_{bc}\omega_{c}) \\& =\quad\frac{1}{2}\omega_{c}^{\mathrm{T}}(R_{bc}^{\mathrm{T}}\mathcal{I}_{b}R_{bc})\end{aligned}$$整理得：$$\color{#fb8b05}\mathcal{I}_{c}=R_{bc}^{\mathrm{T}}\mathcal{I}_{b}R_{bc}$$这是*坐标系发生纯旋转*的情况的公式（原点相同，仅姿态变化）。
	
	$$\color{#fb8b05}\mathcal{I}_{q}=\mathcal{I}_{b}+\mathrm{m}(q^{\mathrm{T}}qI-qq^{\mathrm{T}})$$这是*坐标系发生纯平移*的情况的公式。（姿态相同，原点从质心平移到另一个点 $q$）
	遇到复合的情况的话就把它们结合起来就行：$I_{\mathrm{ncw}}=R^T\left(I_b+m(\|q\|^2I-qq^T)\right)R$



### 【2】基于旋量的一般刚体动力学：

上面【1】.2的一般刚体动力学方程可以整理一下变成矩阵的形式：$$\left.\left[
\begin{array}
{cc}m_b \\
f_b
\end{array}\right.\right]=
\begin{bmatrix}
\mathcal{I}_b & 0 \\
0 & \mathfrak{m}I
\end{bmatrix}
\begin{bmatrix}
\dot{\omega}_b \\
\dot{v}_b
\end{bmatrix}+
\begin{bmatrix}
[\omega_b] & 0 \\
0 & [\omega_b]
\end{bmatrix}
\begin{bmatrix}
\mathcal{I}_b & 0 \\
0 & \mathfrak{m}I
\end{bmatrix}
\begin{bmatrix}
\omega_b \\
v_b
\end{bmatrix}$$依旧是根据矩阵性质$[v]v=v\times v\mathrm{and}[v]^{\mathrm{T}}=-[v]$，可以写作下列等价形式：$$\begin{aligned}
\begin{bmatrix}
m_{b} \\
f_{b}
\end{bmatrix} & \left.=\left[
\begin{array}
{cc}{\mathcal{I}_{b}} & {0} \\
{0} & {\mathfrak{m}I}
\end{array}\right.\right]
\begin{bmatrix}
{\dot{\omega}_{b}} \\
{i_{b}}
\end{bmatrix}+
\begin{bmatrix}
{[\omega_{b}]} & {[v_{b}]} \\
{0} & {[\omega_{b}]}
\end{bmatrix}
\begin{bmatrix}
{\mathcal{I}_{b}} & {0} \\
{0} & {\mathfrak{m}I}
\end{bmatrix}
\begin{bmatrix}
{\omega_{b}} \\
{v_{b}}
\end{bmatrix} \\
 & \left.=\left[
\begin{array}
{cc}{I_{b}} & {0} \\
{0} & {\mathrm{m}I}
\end{array}\right.\right]
\begin{bmatrix}
{\dot{\omega}_{b}} \\
{\dot{v}_{b}}
\end{bmatrix}-
\begin{bmatrix}
{[\omega_{b}]} & {0} \\
{[v_{b}]} & {[\omega_{b}]}
\end{bmatrix}^{\mathrm{T}}
\begin{bmatrix}
{I_{b}} & {0} \\
{0} & {\mathrm{m}I}
\end{bmatrix}
\begin{bmatrix}
{\omega_{b}} \\
{v_{b}}
\end{bmatrix}
\end{aligned}$$可以发现最终式子里有我们熟悉的$V=\begin{bmatrix} \omega_b \\ v_b \end{bmatrix}$和$\dot{V}=\begin{bmatrix} \dot{\omega}_b \\ \dot{v}_b \end{bmatrix}$，同时都有一个矩阵$\begin{bmatrix} I_b & 0 \\ 0 & \mathrm{m}I \end{bmatrix}$所以我们引入一个新概念：
*空间惯量矩阵*：$$\color{#fb8b05}\mathcal{G}_{b}=
\begin{bmatrix}
{\mathcal{I}_{b}} & {0} \\
{0} & {\mathfrak{m}I}
\end{bmatrix}$$*其相当于空间运动旋量$V$中的质量*
从下面刚体在空间下的动能表示就可以更直观地看出来。$$\text{kinetic energy}=\frac{1}{2}\omega_{b}^{\mathrm{T}}\mathcal{I}_{b}\omega_{b}+\frac{1}{2}\mathrm{m}v_{b}^{\mathrm{T}}v_{b}=\frac{1}{2}\mathcal{V}_{b}^{\mathrm{T}}\mathcal{G}_{b}\mathcal{V}_{b}$$这里前面是旋转动能，后面是线性动能。加起来就是刚体的总动能。
（这里这个公式要与[[8.1 动力学——拉格朗日公式]]中的公式区分，这是两种做法下的两个公式，说的都是同一件事，只是方法不同）

同样的，*空间惯量矩阵也可以改变参考系*：$$\begin{aligned} \frac{1}{2}\nu_{a}^{\mathrm{T}}g_{a}\nu_{a} & =\frac{1}{2}\nu_{b}^{\mathrm{T}}\mathcal{G}_{b}\mathcal{V}_{b} \\ & =\frac{1}{2}([\mathrm{Ad}_{T_{ba}}]\mathcal{V}_{a})^{\mathrm{T}}\mathcal{G}_{b}[\mathrm{Ad}_{T_{ba}}]\mathcal{V}_{a} \\ & =\frac{1}{2}\mathcal{V}_{a}^{\mathrm{T}}\underbrace{[\mathrm{Ad}_{T_{ba}}]^{\mathrm{T}}\mathcal{G}_{b}[\mathrm{Ad}_{T_{ba}}]}_{\mathcal{G}_{a}}\mathcal{V}_{a}; \end{aligned}$$即$$\color{#fb8b05}\mathcal{G}_{a}=[\mathrm{Ad}_{T_{ba}}]^{\mathrm{T}}\mathcal{G}_{b}[\mathrm{Ad}_{T_{ba}}].$$

可以发现上面那个力旋量的矩阵右边只剩下$$
\begin{bmatrix}
[\omega_b] & 0 \\
[v_b] & [\omega_b]
\end{bmatrix}^\mathrm{T}$$我们不知道。这里我们回顾一下伴随矩阵的定义。
给定一个 twist $V = (\omega, v)$, 其对应的伴随表示（李括号的矩阵形式）为:
$$[ad_V] = \begin{bmatrix}
[\omega] & 0 \\
[v] & [\omega]
\end{bmatrix} \in \mathbb{R}^{6 \times 6}$$
所以转置矩阵$[ad_V]^T:$

$$[ad_V]^T=\begin{bmatrix}[\omega]^T&[v]^T\\0&[\omega]^T\end{bmatrix}=\begin{bmatrix}-[\omega]&-[v]\\0&-[\omega]\end{bmatrix}$$

因为叉积矩阵满足$[\omega]^T=-[\omega]$ (斜对称性)。
所以我们可以把上面整理的力旋量式子写成：
$$\color{#fb8b05}\mathcal{F}_a=\mathcal{G}_a\dot{\mathcal{V}}_a-[\mathrm{ad}_{\mathcal{V}_a}]^\mathrm{T}\mathcal{G}_a\mathcal{V}_a$$这就是*一般刚体的逆动力学公式*👆
给定运动旋量和加速度，我们可以计算出产生这种运动所需的力旋量。
注意，第二项是速度乘积项。

同样我们可以写出*一般刚体的正向动力学公式*👇：$$\color{#fb8b05}\dot{\mathcal{V}}_b=\mathcal{G}_b^{-1}(\mathcal{F}_b+[\mathrm{ad}_{\mathcal{V}_b}]^\mathrm{T}\mathcal{G}_b\mathcal{V}_b)$$输入当前的运动旋量和力旋量，以计算刚体的加速度。