
### 【1】运动规划的概述定义：
运动规划需要关注的关键是*C-space*[[2.1 C-space]]，回忆一下，
	C空间中的每个点对应于机器人的唯一位形$q=(\theta_1,.....,\theta_n)$
	C空间是由自由C空间（机器人不碰到障碍物且满足关节要求的空间位形）和障碍C空间（机器人与障碍物相碰的空间位形）组成的$C=C_{free}∪C_{obs}$
	机器人的状态：$x=(q,v)$也就是位形$T$和速度$V$
	输入的控制量：$u$，通常是力矩$\tau$什么的
	则机器人的运动方程就是$\dot{x}=f(x,u)$
	这里的$\dot{x}=(v,\dot{v})$其实就是给定位形，速度，力矩，求出它的速度和加速度。速度是一样的，求加速度就是动力学的部分。
因此运动规划就是，给定一共$x(0)=x_{start}$以及期望的最终状态$x_{goal}$，找到一个时间$T$和一组控制$u$使得$x(T)=x(0)+\int_0^T f(x(t), u(t)) d t$

这里对运动规划有几个特点需要提一下：
	1，*运动规划其实就是在$C$空间内找路径*（初始状态到目标状态）。因为其在$C$空间内找路径，所以与普通的在工作空间内找路径的路径规划要有所区别。路径规划是运动规划的一个子问题。因为运动规划除了路径规划以外，还要考虑运动学的信息。
	2，在线算法和离线算法：如果环境里的障碍物不会突然出现，是静态的环境，那可以用离线算法。但是如果环境是动态的，就得用在线算法。
	3，多查询和单查询规划：如果机器人在一个不变的环境内求解许多运动规划问题，那花时间构建准确表示$C_{free}$的数据结构是值得的，这叫多查询。反之，就叫单查询。


接着讲几个要用到的概念：
	1，自由空间$C_{free}$和障碍空间$C_{obs}$，上面也有提到这两个概念。利用这两个概念，其实机器人的运动规划就是在自由空间内寻找路径的问题。而这两个空间会把整体的空间分成一块一块的，我们称作连通分量。
	![[Pasted image 20250717144034.png]]
	2，与障碍物距离的碰撞检测：
	其实就是把机器人和障碍物都视作无数个很小的小球构成的，于是机器人和障碍物之间的距离可以通过下式计算：$$d(q, \mathcal{B})=\min _{i, j}\left\|r_i(q)-b_j\right\|-R_i-B_j$$这里的小$r$和小$b$是中心位置，大$R$和大$B$是半径。
	3，图和树，这个数据结构学过了，这里就不多说了。
	4，*路线图*：路线图是构型空间（C-space）中自由空间的拓扑表示，如下图![[Pasted image 20250717145237.png]]
	其实就是把C空间表示成图，这样我们就可以用图的路径搜索算法来解决C空间内的路径寻找问题了。
	5，*A$*$搜索*：一个用作图里，寻找起点到终点的最短路径的算法。
	有点像Dijkstra但是加入了离终点的距离作为”成本“，并且记录最优点的上一个点用作路径生成。始终走“成本最低”的那条路。
	下面有两个视频讲这个算法的，b站的是基于网格的算法过程，YouTube是基于普通图的算法过程。
	https://www.bilibili.com/video/BV1bv411y79P/?spm_id_from=333.1391.0.0&vd_source=c3b599847423d57b6a814ddc20214651
	https://www.youtube.com/watch?v=ZI800-2jv38&list=PLggLP4f-rq02vX0OQQ5vrCxbJrzamYDfx&index=53


### 【2】完整路径规划器
完整的路径规划依赖于$C_{free}$的精确表示,这在数学上和算法上都是复杂的，对于许多实际系统来说是不切实际的，所以这里不做详细解释。
![[Pasted image 20250717145523.png]]
图$b$是用代表机器人的正方形贴着障碍物绕一圈，机器人与该障碍物的极限贴近范围。



### 【3】网格方法
生成路线图（也就是把C空间离散化）的最直接的方法就是*网格化*。
![[Pasted image 20250717145807.png]]
生成网格之后就可以用A$*$算法来进行寻找路径了。
需要注意的就是，算法本身要求记录到终点的距离作为”成本“，所以要看这个机器人的C空间生成的网格是4连通的还是8连通的，来决定距离是两点之间的直线距离，还是长加高的曼哈顿距离


在网格方法里面还有两种特殊方法：

- 1，*波前规划器*：用于同一环境下多查询情况，可以把环境生成的网格做一些多的处理。 ![[Pasted image 20250717150206.png]]
目标位形的分数为0。

- 2，*多分辨率网格表示法*：用于降低网格的复杂度。其实就是把障碍物附近的空间用密集细小的网格表示（高分辨率），把空旷开阔的空间用稀疏较大的网格表示（低分辨率）。
![[Pasted image 20250717150432.png]]



### 【3】采样方法
这个名字有点抽象，其实就是构建C空间的路线图的方法，跟网格法构建路线图一样。不过其的整体特点是”*随机*性“，”*快速地解决高复杂度的运动规划问题*“，但是可能准确度和最优度并没有那么高。


- 1，*PRM（概率路线图）*
$PRM$就像在迷宫里*随机撒点+连路*，最后用现成的地图找最短路径。

具体过程：
想象你要在一个布满障碍物的仓库里规划一条从A到B的路径，但仓库太大，没法一点点检查每个角落。PRM 的做法是：
1.随机撒点：
    - 在仓库里随便扔一堆“路标点”（但要确保这些点不在货架上）。
    - 比如扔了1000个点，其中800个落在空地，200个砸到货架（直接扔掉）。
2.连路：
    - 把附近的路标点用直线连起来（检查连线是否撞到货架）。  
    - 比如点1和点2距离近，且直线路径没撞货架，就画一条路。
3.用现成地图导航：
    - 当有人问“从A到B怎么走？”时，直接在这张连好路的地图上搜最短路径（比如用A$*$算法）。
![[Pasted image 20250717151059.png]]



- 2，*RRT（快速随机树）*
$RRT$就像在迷宫里“*种一棵疯长的树*”

具体做法就是：
1，树种位置：迷宫起点放一颗种子（树根）
2，让树随机生长，碰到墙就换方向。这样不断地生成新枝芽。
3，最后有树枝到达出口，就完成了路线图的构建
![[Pasted image 20250717151412.png]]



### 【4】虚拟势场
其实就是类似于”*深谷中的小球*“受重力滚落至最低点的自动找路径的过程。
其中，我们把目标点看作深谷的最低点，它提供了重力的吸引力。
而障碍物看作深谷中的高山，它提供了排斥力。
于是小球在这个引力环境中滚落的轨迹就是我们要求的路径。
![[Pasted image 20250717151842.png]]


需要注意的就是，这个势场法，一个重要的问题就是可能会有局部最小值的存在，小球会卡在半山坡。解决它的办法就是一个叫”导航函数“的东西。



### 【5】非线性优化
有点像把路径当成一个数学题，写一个目标函数 + 一堆限制条件，然后让电脑去找最优解。
这里的目标函数包括目标点，同时也有最优目标（例如最短路径，时间最短，最稳定等）。